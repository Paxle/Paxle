## getting resourcebundle to translate site
#set( $text = $resourceTool.bundle('OSGI-INF/l10n/overview'))

## Page title
#set($page_title = ${text.browser.title})

#set( $h1 = "<script src='/js/prototype.js' type='text/javascript'></script>")
#set( $page_headers = [$h1] )

## Content
<fieldset class="infobox" id="dsystem">
	<legend class="ovSystem">${text.legend.ovSystem}</legend>
	<table>
		<tr>
			<th>${text.table.name}</th>
			<th>${text.table.value}</th>
		</tr>
		<tr>
			<td><b>${text.ovSystem.cpus}</b></td>
			<td>${runtime.availableProcessors()}</td>
		</tr>
		<tr>
			<td><b>${text.ovSystem.os}</b></td>
			<td>$sysprops.get("os.arch") $sysprops.get("os.name") $sysprops.get("os.version")</td>
		</tr>
		<tr>
			<td><b>${text.ovSystem.jvm}</b></td>
			<td>$sysprops.get("java.vendor")<br />$sysprops.get("java.runtime.name")<br />$sysprops.get("java.version")</td>
		</tr>
		<tr>
			<td><b>${text.ovSystem.osgi.insert($osgiVersion)}</b></td>
			<td>by $frameworkVendor,<br />version $frameworkVersion</td>
		</tr>
	</table>
</fieldset>

<fieldset class="infobox" id="dmemory">
	<legend class="ovMemory">${text.legend.ovMemory}</legend>
	#set($used = ( $runtime.totalMemory() - $runtime.freeMemory()) / ( 1024 * 1024))
	#set($free = ( $runtime.maxMemory() - $runtime.totalMemory() + $runtime.freeMemory()) / ( 1024 * 1024))
	#set($total = $runtime.maxMemory() / ( 1024 * 1024))
	#set($disk = ${overview.getFreeDiskspaceKb()} / 1024)
	<table>
		<tr>
			<th>${text.table.name}</th>
			<th>${text.table.value}</th>
		</tr>
		<tr>
			<td><b>${text.ovMemory.memUsed}</b></td>
			<td>$used MiB</td>
	    </tr>
	    <tr>
			<td><b>${text.ovMemory.memFree}</b></td>
			<td>$free MiB</td>
		</tr>
		<tr>
			<td><b>${text.ovMemory.memTotal}</b></td>
			<td>$total MiB</td>
		</tr>
		<tr>
			<td><b>${text.ovMemory.diskFree}</b></td>
			<td>$disk MiB</td>
		</tr>		
		<tr>
			<td><b>${text.ovMemory.memMisc}</b></td>
			<td>
				<form action="/overview" method="post">
					<div>
						<input type="hidden" name="gc" value="GC" />
						<input type="submit" value="${text.ovMemory.memMisc.runGC}" />
					</div>
				</form>
			</td>
		</tr>
	</table>
</fieldset>

<fieldset class="infobox" id="dhost">
	<legend class="ovHost">${text.legend.ovHost}</legend>
	<table>
		<tr>
			<th>${text.table.name}</th>
			<th>${text.table.value}</th>
		</tr>
		<tr>
			<td><b>${text.ovHost.hostname}</b></td>
			<td>$hostname</td>
		</tr>
		<tr>
			<td><b>${text.ovHost.ip}</b></td>
			<td>$ip:$port</td>
		</tr>
	</table>
</fieldset>

<script type="text/javascript">
   var ajaxPopulater = function (id,reload){
    var url  = '/overview?reload=' + reload;
    new Ajax.PeriodicalUpdater(id, url,   
    {
     method: 'post',
     frequency: 5,
     asynchronous: true,
     decay: 1
    });
   };
   
   ajaxPopulater('infoBoxActivity','activity');
	 ajaxPopulater('infoBoxKnownDocuments','knownDocuments');
	 </script>

	 <div id="infoBoxKnownDocuments">
		#parse('/resources/templates/OverViewKnownDocuments.vm')
	 </div>

  <div id="infoBoxActivity">
	#parse('/resources/templates/OverViewActivity.vm')
  </div>
	<br style="clear:left;" />
