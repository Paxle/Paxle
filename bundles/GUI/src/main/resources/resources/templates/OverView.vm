## Page title
#set($page_title = "Paxle Peer Status")

#set( $h1 = "<script src='/js/prototype.js' type='text/javascript'></script>")
#set( $page_headers = [$h1] )

## Content
<fieldset class="infobox" id="dsystem">
	<legend class="ovSystem">System</legend>
	<table>
		<tr>
			<th>Name</th>
			<th>Value</th>
		</tr>
		<tr>
			<td><b>CPUs</b></td>
			<td>$runtime.availableProcessors()</td>
		</tr>
		<tr>
			<td><b>OS</b></td>
			<td>$sysprops.get("os.arch") $sysprops.get("os.name") $sysprops.get("os.version")</td>
		</tr>
		<tr>
			<td><b>JVM</b></td>
			<td>$sysprops.get("java.vendor")<br />$sysprops.get("java.runtime.name")<br />$sysprops.get("java.version")</td>
		</tr>
		<tr>
			<td><b>OSGi v$osgiVersion</b></td>
			<td>by $frameworkVendor,<br />version $frameworkVersion</td>
		</tr>
	</table>
</fieldset>

<fieldset class="infobox" id="dmemory">
	<legend class="ovMemory">Memory</legend>
	#set($used = ( $runtime.totalMemory() - $runtime.freeMemory()) / ( 1024 * 1024))
	#set($free = ( $runtime.maxMemory() - $runtime.totalMemory() + $runtime.freeMemory()) / ( 1024 * 1024))
	#set($total = $runtime.maxMemory() / ( 1024 * 1024))
	<table>
		<tr>
			<th>Name</th>
			<th>Value</th>
		</tr>
		<tr>
			<td><b>Memory used</b></td>
			<td>$used MiB</td>
	    </tr>
	    <tr>
			<td><b>Memory free</b></td>
			<td>$free MiB</td>
		</tr>
		<tr>
			<td><b>Memory total</b></td>
			<td>$total MiB</td>
		</tr>
		<tr>
			<td><b>Memory misc</b></td>
			<td>
				<form action="/overview" method="post">
					<div>
						<input type="hidden" name="gc" value="GC" />
						<input type="submit" value="run Garbage Collection" />
					</div>
				</form>
			</td>
		</tr>
	</table>
</fieldset>

<fieldset class="infobox" id="dhost">
	<legend class="ovHost">Host</legend>
	<table>
		<tr>
			<th>Name</th>
			<th>Value</th>
		</tr>
		<tr>
			<td><b>Hostname</b></td>
			<td>$hostname</td>
		</tr>
		<tr>
			<td><b>IP</b></td>
			<td>$ip:$port</td>
		</tr>
	</table>
</fieldset>

<script type="text/javascript">
   var ajaxPopulater = function (id,reload){
    var url  = '/overview?reload=' + reload;
    new Ajax.PeriodicalUpdater(id, url,   
    {
     method: 'post',
     frequency: 5,
     asynchronous: true,
     decay: 1
    });
   };
   
   ajaxPopulater('infoBoxActivity','activity');
	 ajaxPopulater('infoBoxKnownDocuments','knownDocuments');
	 </script>

	 <div id="infoBoxKnownDocuments">
		#parse('/resources/templates/OverViewKnownDocuments.vm')
	 </div>

  <div id="infoBoxActivity">
	#parse('/resources/templates/OverViewActivity.vm')
  </div>
	<br style="clear:left;" />
