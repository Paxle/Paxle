#*
 * This file is part of the Paxle project.
 * Visit http://www.paxle.net for more information.
 * Copyright 2007-2009 the original author or authors.
 *
 * Licensed under the terms of the Common Public License 1.0 ("CPL 1.0").
 * Any use, reproduction or distribution of this program constitutes the recipient's acceptance of this agreement.
 * The full license text is available under http://www.opensource.org/licenses/cpl1.0.txt
 * or in the file LICENSE.txt in the root directory of the Paxle distribution.
 *
 * Unless required by applicable law or agreed to in writing, this software is distributed
 * on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *#
#set( $menuManager = $manager.getService("org.paxle.gui.IMenuManager"))

#macro(menu $parent $depth)
	#foreach($item in $parent.getMenuItemList())
    	#if($item.getUrl() && $current == $item.getUrl())
    	<li class="menuItemActive">
    	#else
    	<li>
    	#end
    		<a #if($item.getUrl())href="$!item.getUrl()"#end>$item.getName($request.getLocales())</a>
			#if($item.hasSubItems())
				<ul class="subnav subnav$depth">
					#set($currDepth = $depth+1)
					#menu($item, $currDepth)
				</ul>
			#end
    	</li>
    #end
#end

#if($menuManager)
	#set($request = $context.get("request"))
    #set($current = $request.getServletPath())
	#menu($menuManager, 0)
#else
	<li class="error bundleNotInstalled">MenuManager not found!</li>
#end